# One combined file per hour: /var/log/pocketlog/YYYY-MM-DD-HH.log
template(name="HourlyCombinedPath" type="string"
         string="/var/log/pocketlog/%$year%-%$month%-%$day%-%$hour%.log")

# RAW payload wrapped in msg='...'; keep it exactly as received (just trim trailing LF)
template(name="kv_line_raw" type="string"
         string="_time=%timegenerated:::date-rfc3339% host=%fromhost-ip% msg='%msg:::drop-last-lf%'\n")

# Single writer ruleset used by both UDP and TCP inputs
ruleset(name="remote_raw") {
  action(type="omfile"
         dynaFile="HourlyCombinedPath"
         template="kv_line_raw"
         createDirs="on" dirCreateMode="0755" FileCreateMode="0644")
}
